{% extends "base.html" %}
{% block title %}Welcome â€“ Workout Tracker{% endblock %}

{% block content %}
<div class="d-flex flex-column align-items-center justify-content-center vh-100 text-center">
  <h1 class="text-white mb-4">Welcome to Workout Tracker</h1>
    <form action="{{ url_for('create_guest') }}" method="POST" class="text-center mt-5">
    <button type="submit" class="btn btn-primary btn-lg">
        Start as Guest
    </button>
    <p class="text-muted mt-2" style="font-size: 0.9rem;">
        User accounts coming in a future update.
    </p>
</form>

</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;

    // Only send if session doesn't already have timezone (prevent loops)
    if (!document.cookie.includes("tz_set=true")) {
      fetch("/set-timezone", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ timezone: tz })
      }).then(() => {
        document.cookie = "tz_set=true; path=/";
        location.reload(); // reload to re-enter with timezone session set
      });
    }
  });
</script>

{% endblock %}
