{% extends "base.html" %}
{% block title %}Workout History â€“ Workout Tracker{% endblock %}

{% block content %}
<div class="row justify-content-center w-100" style="max-width: 400px;">

  <!-- Top Card -->
  <div class="col-12 mb-3">
    {% if chosen_date %}
      <div class="d-flex justify-content-between align-items-center">
        <a href="{{ url_for('history', date=prev_date) }}"
           class="btn btn-outline-light btn-sm"
           title="Previous Day">
          <i class="bi bi-chevron-left"></i>
        </a>

        <div class="card home-card px-4 py-1 text-center">
          <div class="fw-semibold">{{ display_date }}</div>
        </div>

        <a href="{{ url_for('history', date=next_date) }}"
           class="btn btn-outline-light btn-sm"
           title="Next Day">
          <i class="bi bi-chevron-right"></i>
        </a>
      </div>
    {% else %}
      <div class="card home-card px-4 py-3 text-center">
        <h5 class="fw-semibold mb-0">Select Date</h5>
      </div>
    {% endif %}
  </div>

  <!-- Bottom Card -->
  <div class="col-12">
    <div class="card home-card p-4">
      {% if chosen_date %}
        {% if sets %}
          <ul class="list-group mb-0">
            {% for s in sets %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <div class="fw-semibold">{{ s[1] }}</div>
                <small class="text-muted">
                  {{ s[2] }} reps &bull; {{ s[3] }} lbs
                  {% if settings.rpe_enabled and s[4] is not none %}
                    &bull; RPE {{ s[4] }}
                  {% endif %}
                </small>
              </div>
              <div class="btn-group btn-group-sm gap-2">
                <a href="{{ url_for('edit_set_route', set_id=s[0], origin='history', date=chosen_date) }}"
                   class="btn btn-outline-secondary btn-sm rounded px-1 py-1"
                   title="Edit this set">
                  <i class="bi bi-pencil"></i>
                </a>
                <form action="{{ url_for('delete_set_route', set_id=s[0]) }}"
                      method="POST"
                      onsubmit="return confirm('Are you sure you want to delete this set?');">
                  <input type="hidden" name="origin" value="history">
                  <input type="hidden" name="date"   value="{{ chosen_date }}">
                  <button type="submit"
                          class="btn btn-outline-danger btn-sm rounded px-1 py-1"
                          title="Delete this set">
                    <i class="bi bi-trash"></i>
                  </button>
                </form>
              </div>
            </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-center text-muted mb-0">
            No sets logged on this date.
          </p>
        {% endif %}
      {% else %}
        <form method="POST" class="d-flex justify-content-center align-items-center">
          <input
            type="date"
            name="date"
            class="form-control form-control-lg w-auto me-3"
            required
          >
          <button type="submit" class="btn btn-primary btn-lg px-4">
            View
          </button>
        </form>
      {% endif %}
    </div>
  </div>

  <!-- Home Button -->
  <div class="col-12 mt-3 text-center">
    <a href="{{ url_for('index') }}"
       class="btn btn-secondary w-100 py-2">
      Home
    </a>
  </div>

</div>
{% endblock %}
